// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace ProtegoFrontend.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "D:\Users\mateu\source\repos\MasProject\ProtegoFrontend\ProtegoFrontend\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "D:\Users\mateu\source\repos\MasProject\ProtegoFrontend\ProtegoFrontend\_Imports.razor"
using System.Net.Http.Json;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "D:\Users\mateu\source\repos\MasProject\ProtegoFrontend\ProtegoFrontend\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "D:\Users\mateu\source\repos\MasProject\ProtegoFrontend\ProtegoFrontend\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "D:\Users\mateu\source\repos\MasProject\ProtegoFrontend\ProtegoFrontend\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "D:\Users\mateu\source\repos\MasProject\ProtegoFrontend\ProtegoFrontend\_Imports.razor"
using Microsoft.AspNetCore.Components.Web.Virtualization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "D:\Users\mateu\source\repos\MasProject\ProtegoFrontend\ProtegoFrontend\_Imports.razor"
using Microsoft.AspNetCore.Components.WebAssembly.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "D:\Users\mateu\source\repos\MasProject\ProtegoFrontend\ProtegoFrontend\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "D:\Users\mateu\source\repos\MasProject\ProtegoFrontend\ProtegoFrontend\_Imports.razor"
using ProtegoFrontend;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "D:\Users\mateu\source\repos\MasProject\ProtegoFrontend\ProtegoFrontend\_Imports.razor"
using ProtegoFrontend.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 11 "D:\Users\mateu\source\repos\MasProject\ProtegoFrontend\ProtegoFrontend\_Imports.razor"
using Blazored.Typeahead;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "D:\Users\mateu\source\repos\MasProject\ProtegoFrontend\ProtegoFrontend\Pages\LifeInsurancePage.razor"
using MasProjekt.Backoffice.Models.Customers;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "D:\Users\mateu\source\repos\MasProject\ProtegoFrontend\ProtegoFrontend\Pages\LifeInsurancePage.razor"
using MasProjekt.Backoffice.Models.Insurance;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "D:\Users\mateu\source\repos\MasProject\ProtegoFrontend\ProtegoFrontend\Pages\LifeInsurancePage.razor"
using Newtonsoft.Json;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "D:\Users\mateu\source\repos\MasProject\ProtegoFrontend\ProtegoFrontend\Pages\LifeInsurancePage.razor"
using ProtegoFrontend.Connection;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "D:\Users\mateu\source\repos\MasProject\ProtegoFrontend\ProtegoFrontend\Pages\LifeInsurancePage.razor"
using System.Text;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "D:\Users\mateu\source\repos\MasProject\ProtegoFrontend\ProtegoFrontend\Pages\LifeInsurancePage.razor"
using System.Net;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "D:\Users\mateu\source\repos\MasProject\ProtegoFrontend\ProtegoFrontend\Pages\LifeInsurancePage.razor"
using System.IO;

#line default
#line hidden
#nullable disable
    [global::Microsoft.AspNetCore.Components.RouteAttribute("/LifeInsurance/{CustomerId:int}")]
    public partial class LifeInsurancePage : global::Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(global::Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 100 "D:\Users\mateu\source\repos\MasProject\ProtegoFrontend\ProtegoFrontend\Pages\LifeInsurancePage.razor"
       
    [Parameter]
    public int CustomerId { get; set; }
    Customer customer;
    RetailCustomer RetailCustomer;
    CorpoCustomer CorpoCustomer;

    bool question1yes;
    bool question1no;
    bool question2yes;
    bool question2no;
    bool question3yes;
    bool question3no;
    bool question4yes;
    bool question4no;
    bool question5yes;
    bool question5no;
    bool question6yes;
    bool question6no;
    bool question7yes;
    bool question7no;
    bool question8yes;
    bool question8no;
    bool question9yes;
    bool question9no;
    bool question10yes;
    bool question10no;
    double Price = 3000.00;

    bool errors = false;

    protected override void OnInitialized()
    {
        customer = Customer.Customers.First(e => e.CustomerId == CustomerId);
        if (customer.GetCustomerData().Contains("Pesel:"))
            RetailCustomer = (RetailCustomer)customer;
        else
            CorpoCustomer = (CorpoCustomer)customer;
    }

    private async void CalculateInsurance()
    {
        int counterYes = 0;
        if(question1yes != false)
            counterYes++;
        if (question2yes != false)
            counterYes++;
        if (question3yes != false)
            counterYes++;
        if (question4yes != false)
            counterYes++;
        if (question5yes != false)
            counterYes++;
        if (question6yes != false)
            counterYes++;
        if (question7yes != false)
            counterYes++;
        if (question8yes != false)
            counterYes++;
        if (question9yes != false)
            counterYes++;
        if (question10yes != false)
            counterYes++;

        if (counterYes >= 3)
            errors = true;
        else
        {
            bool[] answers = new bool[10];
            if (question1no != false)
                answers[0] = false;
            else
                answers[0] = true;
            if (question2no != false)
                answers[1] = false;
            else
                answers[1] = true;
            if (question3no != false)
                answers[2] = false;
            else
                answers[2] = true;
            if (question4no != false)
                answers[3] = false;
            else
                answers[3] = true;
            if (question5no != false)
                answers[4] = false;
            else
                answers[4] = true;
            if (question6no != false)
                answers[5] = false;
            else
                answers[5] = true;
            if (question7no != false)
                answers[6] = false;
            else
                answers[6] = true;
            if (question8no != false)
                answers[7] = false;
            else
                answers[7] = true;
            if (question9no != false)
                answers[8] = false;
            else
                answers[8] = true;
            if (question10no != false)
                answers[9] = false;
            else
                answers[9] = true;



            Survey survey = new Survey(answers);
            LifeInsurance LifeInsurance;
            int customerAge = DateTime.Now.Year - Int32.Parse($"19{RetailCustomer.Pesel[0]}{RetailCustomer.Pesel[1]}");
            LifeInsurance = new LifeInsurance(Insurance.Insurances.OrderBy(e => e.InsuranceId).Last().InsuranceId + 2, RetailCustomer.Name, RetailCustomer.Surname, RetailCustomer.Pesel, Price, DateTime.Now, DateTime.Now.AddYears(1), $"L{DateTime.Now.Date}{RetailCustomer.Pesel}", customerAge, survey);
            customer.Insurances.Add(LifeInsurance);
            Insurance.Insurances.Add(LifeInsurance);

            InsurancesModel SerializeInsurance = new InsurancesModel
                {
                    InsuranceId = LifeInsurance.InsuranceId,
                    Name = LifeInsurance.Name,
                    Surname = LifeInsurance.Surname,
                    Pesel = LifeInsurance.PESEL,
                    Price = LifeInsurance.Price,
                    SignDate = LifeInsurance.SignDate,
                    EndDate = LifeInsurance.EndDate,
                    InsuranceNumber = LifeInsurance.InsuranceNumber,
                    AutoCasco = false,
                    VehicleId = 0,
                    CustomerAge = LifeInsurance.CustomerAge,
                    Survey1 = answers[0],
                    Survey2 = answers[1],
                    Survey3 = answers[2],
                    Survey4 = answers[3],
                    Survey5 = answers[4],
                    Survey6 = answers[5],
                    Survey7 = answers[6],
                    Survey8 = answers[7],
                    Survey9 = answers[8],
                    Survey10 = answers[9],
                    City = " ",
                    PostalCode = " ",
                    Street = " ",
                    HouseNumber = " ",
                    FlatNumber = " ",
                    CustomerId = customer.CustomerId
                };

            List<InsurancesModel> model = await Http.GetFromJsonAsync<List<InsurancesModel>>("sample-data/Insurances.json");
            model.Add(SerializeInsurance);
            await Http.PostAsJsonAsync<List<InsurancesModel>>("https://localhost:44394/SaveLife", model);
            NavManager.NavigateTo("/Dashboard");
        }

    }

#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private NavigationManager NavManager { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private HttpClient Http { get; set; }
    }
}
#pragma warning restore 1591
